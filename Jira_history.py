CREATE TABLE ANALYTICS.TOLOG_TEMP_DBO_MSG (
    THREADID VARCHAR2(50),
    DEPARTMENTID VARCHAR2(50),
    DTM DATE,
    OPERATORFULLNAME VARCHAR2(255),
    OPERATORID VARCHAR2(50),
    CREATED DATE,
    STATE VARCHAR2(50),
    CATEGORY VARCHAR2(50),
    SUBCATEGORY VARCHAR2(50),
    PROVIDEDID VARCHAR2(50),
    NAME_ VARCHAR2(255),
    SEG VARCHAR2(50),
    DATE_MSG DATE,
    SENDERNAME_MSG VARCHAR2(255),
    MSG CLOB,
    KIND VARCHAR2(50)
);

INSERT INTO ANALYTICS.TOLOG_TEMP_DBO_MSG
SELECT /*+ PARALLEL(16) */ 
    a.THREADID, 
    a.DEPARTMENTID, 
    a.DTM, 
    a.OPERATORFULLNAME,
    a.OPERATORID, 
    a.CREATED, 
    a.STATE, 
    a.CATEGORY, 
    a.SUBCATEGORY, 
    a.PROVIDEDID, 
    a.NAME_, 
    a.SEG,
    d.CREATED as DATE_MSG,
    d.SENDERNAME as SENDERNAME_MSG,
    d.MESSAGE as MSG,
    d.KIND as KIND
FROM ANALYTICS.TOLOG_TEMP_DBO a
LEFT JOIN ODS.ODS_WIS_CHATMESSAGE@cdw.prod d on a.THREADID = d.THREADID;
