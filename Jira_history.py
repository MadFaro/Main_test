Error starting at line : 1 in command -
UPDATE analytics.kdi_ipoteka_final_with_time_fix
SET DATE_BEGIN_CRIF_FIX = DATE_IN_WORK_FIX -
    (180 - ((EXTRACT(HOUR FROM CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP)) - 17) * 60 + EXTRACT(MINUTE FROM CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP))) +
    CASE 
        WHEN TO_CHAR(DATE_IN_WORK_FIX, 'Day') IN ('Воскресенье', 'Суббота    ') THEN 
            (EXTRACT(HOUR FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP)) - 8) * 60 + EXTRACT(MINUTE FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP))
        ELSE 
            (EXTRACT(HOUR FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP)) - 7) * 60 + EXTRACT(MINUTE FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP))
    END) / 24 / 60
WHERE 
    EXTRACT(HOUR FROM (CAST(DATE_IN_WORK_FIX AS TIMESTAMP) - CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP) DAY TO SECOND)) > 2
    AND EXTRACT(HOUR FROM (CAST(DATE_IN_WORK_FIX AS TIMESTAMP) - CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP) DAY TO SECOND)) < 18
    AND EXTRACT(HOUR FROM CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP)) >= 17
    AND 180 - ((EXTRACT(HOUR FROM CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP)) - 17) * 60 + EXTRACT(MINUTE FROM CAST(DATE_BEGIN_CRIF_FIX AS TIMESTAMP))) +
    CASE 
        WHEN TO_CHAR(DATE_IN_WORK_FIX, 'Day') IN ('Воскресенье', 'Суббота    ') THEN 
            (EXTRACT(HOUR FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP)) - 8) * 60 + EXTRACT(MINUTE FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP))
        ELSE 
            (EXTRACT(HOUR FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP)) - 7) * 60 + EXTRACT(MINUTE FROM CAST(DATE_IN_WORK_FIX AS TIMESTAMP))
    END < 180
Error at Command Line : 11 Column : 119
Error report -
SQL Error: ORA-00907: отсутствует правая скобка
00907. 00000 -  "missing right parenthesis"
*Cause:    
*Action:
