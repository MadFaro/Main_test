WITH TableInfo AS (
    SELECT 'ANALYTICS.CISCO_SL_TABLE' AS Tab, 'INTERV' AS DateCol FROM DUAL UNION ALL
    SELECT 'ANALYTICS.CISCO_OPERATOR', 'DATETIME' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_ISXOD_CISCO_DDO', 'Origination' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CHAT_TIME_ONE', 'DTM_DIALOG' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_RETENTIONS_CHATS_TABLE', 'created' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_RETENTIONS_CALLS_TABLE', 'DT' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CHAT_TIME_TWO', 'CREATED' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CLOSED_CARDS_AND_PACKAGES_ON_CALL', 'TIME_CLOSE' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CISCO_OPERATOR_STATE', 'DATE_' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_TRANSFERRED_CALLS', 'DATE_FROM' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CISCO_MONITORING_SKILL_30', 'INTERVAL' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_ISXOD_CISCO_MONITORING', 'Origination' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_ONECTA_BI_TABLE', 'DATE_HOUR' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CALLS_THEMS_V1', 'DT_DAY' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CHATS_THEMS', 'CREATED' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_RETENTIONS_FINALLY_TABLE', 'DATE_CREATED' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CHAT_HOLD', 'DTM' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_CHAT_HOLD_V2', 'DTM' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_WEBIM_CHAT_TABLE', 'DT' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_WEBIM_CHAT_RETURN', 'DT' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_IVR_QE', 'TIMESTAMP_' FROM DUAL UNION ALL
    SELECT 'ANALYTICS.TOLOG_DNT', 'CREATED_TZ' FROM DUAL
)
SELECT 
    Tab,
    MAX(Date_time) AS Date_time
FROM (
    SELECT 
        Tab,
        TO_DATE(CAST(XMLQUERY('OraView("' || Tab || '")' RETURNING CONTENT).getStringVal() AS VARCHAR2(30)), 'YYYY-MM-DD HH24:MI:SS') AS Date_time
    FROM 
        TableInfo
) 
WHERE Date_time >= TRUNC(SYSDATE - 1)
GROUP BY Tab;
