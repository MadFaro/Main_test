SELECT
trunc(TO_DATE(REPORT_MONTH, 'YYYY-MM-DD'), 'mm') as REPORT_MONTH, 
MOTIV_TABNUM, 
PRODUKT, 
COUNT(DISTINCT DOG) as dog_cnt
FROM BALKHOVITIAV.VIEW_MOTIV_PRAIC_LICT_OPROS
WHERE trunc(TO_DATE(REPORT_MONTH, 'YYYY-MM-DD'), 'mm') >= add_months(trunc(sysdate-1, 'mm'),-3)
GROUP BY trunc(TO_DATE(REPORT_MONTH, 'YYYY-MM-DD'), 'mm'), MOTIV_TABNUM, PRODUKT;
