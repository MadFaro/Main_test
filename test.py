import pandas as pd

file_path = r"V:\VOL2\Contact-center\Файлы\Аналитика\Численность ДДО\022025\3.Чаты\Профиль нагрузки_чаты_022025.xlsx"
data = pd.read_excel(file_path, skiprows=1, usecols=range(28, 54))  # Столбцы AC-BC (28-53)
data = data.drop(columns=data.columns[[1, 2]])
data = data[data.iloc[:, 13].notna()]

# Получаем даты из первого столбца
dates = pd.read_excel(file_path, usecols=[0], skiprows=1)  # Первый столбец — дата

# Создаем список строк для вывода
rows = []

# Перебираем все строки
for i, row in data.iterrows():
    # Извлекаем дату для текущей строки
    date = dates.iloc[i, 0].strftime("%d.%m.%Y")  # Форматируем дату в нужный формат (DD.MM.YYYY)
    
    # Преобразуем все значения в строках (если они числа)
    values = row.apply(pd.to_numeric, errors='coerce').fillna(0).astype(int).values  # Все значения в целые числа
    
    # Перебираем данные по часам с 00:00
    for hour in range(24):
        time = f"{hour:02d}:00"
        value = values[hour]  # Получаем значение для текущего часа
        rows.append(["WEBIM_Chat", date, time, "01:00", value])  # Формируем строку для записи

# Создаем DataFrame для результата
output_df = pd.DataFrame(rows, columns=["Имя очереди", "Дата", "Время", "Интервал времени", "Требования ЭПЗ"])

# Сохраняем в текстовый файл с нужным форматом
output_file = "output.txt"
with open(output_file, "w", encoding="utf-8") as f:
    # Пишем заголовок
    f.write("DATE_TIME_FORMAT\n")
    f.write("DD.MM.YYYY HH:mm\n")
    f.write("Имя очереди\tДата\tВремя\tИнтервал времени\tТребования ЭПЗ\n")
    
    # Записываем данные построчно
    for _, row in output_df.iterrows():
        line = "\t".join(str(value) for value in row)  # Преобразуем все значения в строку с табуляцией
        f.write(line + "\n")  # Записываем строку с новой строкой в конце

print(f"Данные успешно преобразованы и сохранены в {output_file}")

дата/часы	день нед.	кол-во РМ	0	1	2	3	4	5	6	7	8	9	10	11	12	13	14	15	16	17	18	19	20	21	22	23
01.02.2025	6	48	7	7	6	7	7	9	16	24	35	45	48	48	47	45	43	39	36	33	30	27	24	21	17	13
02.02.2025	7	38	6	6	5	6	6	7	12	20	28	36	38	38	37	36	35	33	31	30	27	25	22	19	16	13
03.02.2025	1	57	7	6	6	6	7	9	16	28	38	49	57	57	56	54	52	49	45	41	37	31	24	20	16	12
04.02.2025	2	66	8	7	7	8	11	15	23	36	47	59	66	66	64	63	61	59	55	52	47	42	35	28	21	15
05.02.2025	3	64	7	6	6	7	10	14	21	34	45	57	64	64	63	61	59	57	54	50	46	40	34	28	20	14
06.02.2025	4	59	6	6	6	6	9	13	19	31	42	53	59	59	58	57	55	53	50	47	43	38	32	26	19	13
07.02.2025	5	57	6	6	6	6	8	12	19	30	41	51	57	57	56	55	53	51	48	45	41	36	31	24	17	13
08.02.2025	6	36	6	6	6	6	6	7	10	17	24	32	36	36	35	34	33	32	30	28	26	23	21	18	15	12
09.02.2025	7	32	5	5	5	5	6	6	9	15	22	28	32	32	32	31	30	29	27	26	24	22	20	17	15	12
10.02.2025	1	64	7	6	6	6	9	13	20	32	44	56	64	63	63	61	59	57	54	50	46	40	34	27	20	14
11.02.2025	2	58	6	6	5	6	8	12	18	29	40	51	58	58	57	56	54	52	49	46	42	37	32	25	18	13
12.02.2025	3	54	6	5	5	6	7	11	17	28	39	49	54	54	54	53	51	49	47	44	40	35	30	24	17	13
13.02.2025	4	56	6	6	5	6	8	12	18	29	40	50	55	56	55	54	52	50	48	44	40	36	30	24	18	13
14.02.2025	5	56	6	6	5	6	8	12	18	30	41	51	56	56	55	54	53	50	48	44	40	35	30	23	17	13
15.02.2025	6	35	6	6	5	5	6	7	10	17	24	31	35	35	34	33	32	31	29	27	25	23	20	18	15	12
16.02.2025	7	32	5	5	5	5	6	6	9	15	21	27	31	32	31	30	29	28	27	25	23	21	19	17	15	12
17.02.2025	1	56	7	6	6	6	8	11	16	27	38	50	56	56	56	55	53	51	48	45	41	37	31	25	19	14
18.02.2025	2	56	7	6	6	7	8	12	17	28	39	50	56	56	56	55	53	51	49	45	42	37	32	26	19	15
19.02.2025	3	56	7	6	6	7	8	12	18	29	40	51	56	56	56	55	53	51	49	46	42	37	32	25	19	14
20.02.2025	4	56	6	6	6	6	8	12	18	30	40	51	55	56	55	54	52	50	48	45	41	36	31	24	18	13
21.02.2025	5	54	6	6	5	6	8	11	18	29	40	50	54	54	54	53	51	49	46	43	38	34	28	22	16	13
22.02.2025	6	34	6	5	5	5	6	7	10	17	23	30	34	34	33	32	31	30	28	27	25	22	20	18	15	12
23.02.2025	7	22	7	7	8	8	9	11	14	16	18	21	21	21	22	22	21	20	19	19	18	17	16	15	15	14
24.02.2025	1	63	7	6	6	6	8	12	19	32	44	56	63	63	62	61	59	57	54	50	46	40	34	27	20	15
25.02.2025	2	68	7	7	6	7	9	13	21	35	48	61	67	68	67	66	64	61	58	54	49	43	37	29	21	15
26.02.2025	3	68	7	7	6	7	9	13	22	36	49	62	68	68	68	66	65	62	59	55	50	44	37	30	21	16
27.02.2025	4	64	7	6	6	7	9	13	20	33	46	59	64	64	63	62	60	58	55	51	47	41	35	27	20	15
28.02.2025	5	68	9	9	8	8	9	10	18	33	48	59	65	67	68	68	67	66	64	61	57	50	43	35	30	25

DATE_TIME_FORMAT
DD.MM.YYYY HH:mm
Имя очереди	Дата	Время	Интервал времени	Требования ЭПЗ
WEBIM_Chat	01.02.2025	00:00	01:00	0
WEBIM_Chat	01.02.2025	01:00	01:00	7
WEBIM_Chat	01.02.2025	02:00	01:00	7
WEBIM_Chat	01.02.2025	03:00	01:00	6
WEBIM_Chat	01.02.2025	04:00	01:00	7
WEBIM_Chat	01.02.2025	05:00	01:00	7
WEBIM_Chat	01.02.2025	06:00	01:00	9
WEBIM_Chat	01.02.2025	07:00	01:00	16
WEBIM_Chat	01.02.2025	08:00	01:00	24
WEBIM_Chat	01.02.2025	09:00	01:00	35
WEBIM_Chat	01.02.2025	10:00	01:00	45
WEBIM_Chat	01.02.2025	11:00	01:00	48
WEBIM_Chat	01.02.2025	12:00	01:00	48
WEBIM_Chat	01.02.2025	13:00	01:00	47
WEBIM_Chat	01.02.2025	14:00	01:00	45
WEBIM_Chat	01.02.2025	15:00	01:00	43
WEBIM_Chat	01.02.2025	16:00	01:00	39
WEBIM_Chat	01.02.2025	17:00	01:00	36
WEBIM_Chat	01.02.2025	18:00	01:00	33
WEBIM_Chat	01.02.2025	19:00	01:00	30
WEBIM_Chat	01.02.2025	20:00	01:00	27
WEBIM_Chat	01.02.2025	21:00	01:00	24
WEBIM_Chat	01.02.2025	22:00	01:00	21
WEBIM_Chat	01.02.2025	23:00	01:00	17
