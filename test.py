SELECT
trunc(REPORT_MONTH, 'mm') as REPORT_MONTH, MOTIV_TABNUM, PRODUKT, COUNT(DISTINCT DOG) as dog_cnt
FROM BALKHOVITIAV.VIEW_MOTIV_PRAIC_LICT_OPROS
WHERE trunc(REPORT_MONTH, 'mm') >= add_months(trunc(sysdate-1, 'mm'),-3)
GROUP BY trunc(REPORT_MONTH, 'mm'), MOTIV_TABNUM, PRODUKT
