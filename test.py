C:\Users\TologonovAB\Desktop>Python test.py
              дата/часы день нед.   итого     0     1     2     3  ...     17     18     19     20     21     22   23
0   2025-02-01 00:00:00         6  5605.0  59.0  55.0  52.0  57.0  ...  291.0  267.0  240.0  213.0  182.0  150.0  113
1   2025-02-02 00:00:00         7  4724.0  50.0  47.0  44.0  48.0  ...  262.0  241.0  219.0  195.0  170.0  144.0  113
2   2025-02-03 00:00:00         1  6410.0  57.0  52.0  48.0  53.0  ...  369.0  326.0  274.0  214.0  174.0  139.0  105
3   2025-02-04 00:00:00         2  7955.0  66.0  60.0  61.0  70.0  ...  461.0  419.0  370.0  314.0  252.0  182.0  127
4   2025-02-05 00:00:00         3  7643.0  58.0  53.0  52.0  58.0  ...  447.0  407.0  359.0  305.0  244.0  177.0  124
5   2025-02-06 00:00:00         4  7111.0  53.0  49.0  47.0  53.0  ...  418.0  380.0  336.0  285.0  228.0  165.0  117
6   2025-02-07 00:00:00         5  6839.0  53.0  48.0  46.0  52.0  ...  402.0  365.0  321.0  271.0  215.0  153.0  111
7   2025-02-08 00:00:00         6  4413.0  53.0  50.0  47.0  46.0  ...  250.0  229.0  207.0  185.0  160.0  133.0  106
8   2025-02-09 00:00:00         7  4002.0  44.0  41.0  39.0  41.0  ...  228.0  210.0  192.0  173.0  150.0  128.0  106
9   2025-02-10 00:00:00         1  7567.0  57.0  52.0  48.0  54.0  ...  447.0  406.0  358.0  304.0  243.0  176.0  124
10  2025-02-11 00:00:00         2  6913.0  53.0  48.0  44.0  50.0  ...  410.0  374.0  330.0  280.0  224.0  162.0  116
11  2025-02-12 00:00:00         3  6552.0  50.0  45.0  42.0  49.0  ...  389.0  354.0  313.0  266.0  212.0  151.0  110
12  2025-02-13 00:00:00         4  6713.0  51.0  47.0  45.0  51.0  ...  395.0  360.0  318.0  269.0  215.0  155.0  114
13  2025-02-14 00:00:00         5  6722.0  52.0  47.0  45.0  50.0  ...  394.0  357.0  313.0  262.0  205.0  147.0  111
14  2025-02-15 00:00:00         6  4283.0  50.0  47.0  44.0  45.0  ...  242.0  222.0  202.0  180.0  156.0  132.0  107
15  2025-02-16 00:00:00         7  3918.0  41.0  39.0  37.0  40.0  ...  223.0  207.0  189.0  170.0  150.0  128.0  107
16  2025-02-17 00:00:00         1  6764.0  56.0  51.0  47.0  50.0  ...  403.0  369.0  327.0  278.0  223.0  163.0  121
17  2025-02-18 00:00:00         2  6854.0  59.0  54.0  50.0  55.0  ...  405.0  371.0  331.0  283.0  228.0  167.0  128
18  2025-02-19 00:00:00         3  6888.0  57.0  53.0  49.0  56.0  ...  407.0  371.0  330.0  281.0  225.0  164.0  126
19  2025-02-20 00:00:00         4  6758.0  54.0  49.0  47.0  54.0  ...  397.0  362.0  320.0  271.0  216.0  155.0  117
20  2025-02-21 00:00:00         5  6498.0  53.0  49.0  45.0  52.0  ...  379.0  342.0  298.0  248.0  191.0  139.0  109
21  2025-02-22 00:00:00         6  4190.0  48.0  44.0  42.0  45.0  ...  235.0  217.0  198.0  177.0  154.0  130.0  107
22  2025-02-23 00:00:00         7  3331.0  57.0  60.0  64.0  70.0  ...  165.0  157.0  149.0  142.0  135.0  130.0  123
23  2025-02-24 00:00:00         1  7539.0  57.0  52.0  47.0  52.0  ...  449.0  409.0  359.0  304.0  241.0  172.0  127
24  2025-02-25 00:00:00         2  8107.0  60.0  55.0  50.0  55.0  ...  483.0  439.0  387.0  326.0  259.0  184.0  135
25  2025-02-26 00:00:00         3  8239.0  60.0  55.0  51.0  58.0  ...  489.0  445.0  392.0  329.0  262.0  184.0  136
26  2025-02-27 00:00:00         4  7695.0  58.0  54.0  51.0  56.0  ...  455.0  415.0  364.0  307.0  243.0  172.0  129
27  2025-02-28 00:00:00         5  8695.0  77.0  74.0  72.0  70.0  ...  542.0  507.0  447.0  379.0  313.0  266.0  224

[28 rows x 27 columns]
Traceback (most recent call last):
  File "C:\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3652, in get_loc
    return self._engine.get_loc(casted_key)
  File "pandas\_libs\index.pyx", line 147, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\index.pyx", line 176, in pandas._libs.index.IndexEngine.get_loc
  File "pandas\_libs\hashtable_class_helper.pxi", line 7080, in pandas._libs.hashtable.PyObjectHashTable.get_item
  File "pandas\_libs\hashtable_class_helper.pxi", line 7088, in pandas._libs.hashtable.PyObjectHashTable.get_item
KeyError: '0'

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "test.py", line 16, in <module>
    value = row[str(hour)]  # Значение из соответствующего часа
  File "C:\Python38\lib\site-packages\pandas\core\series.py", line 1007, in __getitem__
    return self._get_value(key)
  File "C:\Python38\lib\site-packages\pandas\core\series.py", line 1116, in _get_value
    loc = self.index.get_loc(label)
  File "C:\Python38\lib\site-packages\pandas\core\indexes\base.py", line 3654, in get_loc
    raise KeyError(key) from err
KeyError: '0'
